/*
 * An implementation of Spatial Navigation for jQuery.
 *
 * Copyright (c) 2014 Luke Chang.
 * https://github.com/luke-chang/jquery-spatialNavigation
 *
 * Licensed under the MPL license.
 */
(function(h){function l(c){var a=c.getBoundingClientRect(),a={left:a.left,top:a.top,width:a.width,height:a.height};a.element=c;a.right=a.left+a.width;a.bottom=a.top+a.height;a.center={x:a.left+Math.floor(a.width/2),y:a.top+Math.floor(a.height/2)};a.center.left=a.center.right=a.center.x;a.center.top=a.center.bottom=a.center.y;return a}function n(c){return{nearPlumbLineIsBetter:function(a){a=a.center.x<c.center.x?c.center.x-a.right:a.left-c.center.x;return 0>a?0:a},nearHorizonIsBetter:function(a){a=
a.center.y<c.center.y?c.center.y-a.bottom:a.top-c.center.y;return 0>a?0:a},nearTargetLeftIsBetter:function(a){a=a.center.x<c.center.x?c.left-a.right:a.left-c.left;return 0>a?0:a},nearTargetTopIsBetter:function(a){a=a.center.y<c.center.y?c.top-a.bottom:a.top-c.top;return 0>a?0:a},topIsBetter:function(a){return a.top},bottomIsBetter:function(a){return-1*a.bottom},leftIsBetter:function(a){return a.left},rightIsBetter:function(a){return-1*a.right}}}function m(c,a){var f=[[],[],[],[],[],[],[],[],[]];c.forEach(function(c){var d=
c.center;f[3*(d.y<a.top?0:d.y<=a.bottom?1:2)+(d.x<a.left?0:d.x<=a.right?1:2)].push(c)});return f}function p(c){for(var a=null,f=[],e=0;e<c.length;e++){var d=c[e];if(d.group.length){a=d.group;f=d.distance;break}}if(!a)return null;a.sort(function(a,c){for(var d=0;d<f.length;d++){var e=f[d](a)-f[d](c);if(e)return e}return 0});return a}var k={},q={left:"right",up:"down",right:"left",down:"up"};h.fn.spatialNavigate=function(c,a,f){if(!c||!a)return null;c=c instanceof h?c.get(0):c;a=a.toLowerCase();f=f||
{};var e=l(c),d=h.map(this.not(c),l),b=n(e),d=m(d,e),e=m(d[4],e.center);switch(a){case "left":b=[{group:e[0].concat(e[3]).concat(e[6]),distance:[b.nearPlumbLineIsBetter,b.topIsBetter]},{group:d[3],distance:[b.nearPlumbLineIsBetter,b.topIsBetter]},{group:d[0].concat(d[6]),distance:[b.nearHorizonIsBetter,b.rightIsBetter,b.nearTargetTopIsBetter]}];break;case "right":b=[{group:e[2].concat(e[5]).concat(e[8]),distance:[b.nearPlumbLineIsBetter,b.topIsBetter]},{group:d[5],distance:[b.nearPlumbLineIsBetter,
b.topIsBetter]},{group:d[2].concat(d[8]),distance:[b.nearHorizonIsBetter,b.leftIsBetter,b.nearTargetTopIsBetter]}];break;case "up":b=[{group:e[0].concat(e[1]).concat(e[2]),distance:[b.nearHorizonIsBetter,b.leftIsBetter]},{group:d[1],distance:[b.nearHorizonIsBetter,b.leftIsBetter]},{group:d[0].concat(d[2]),distance:[b.nearPlumbLineIsBetter,b.bottomIsBetter,b.nearTargetLeftIsBetter]}];break;case "down":b=[{group:e[6].concat(e[7]).concat(e[8]),distance:[b.nearHorizonIsBetter,b.leftIsBetter]},{group:d[7],
distance:[b.nearHorizonIsBetter,b.leftIsBetter]},{group:d[6].concat(d[8]),distance:[b.nearPlumbLineIsBetter,b.topIsBetter,b.nearTargetLeftIsBetter]}];break;default:return null}f.crossOnly&&b.pop();b=p(b);if(!b)return null;var g;if(!f.ignorePrevious&&k.destination===c&&k.reverse===a)for(f=0;f<b.length;f++)if(b[f].element===k.start){g=b[f].element;break}g||(g=b[0].element);k={start:c,destination:g,reverse:q[a]};return h(g)}})(jQuery);
